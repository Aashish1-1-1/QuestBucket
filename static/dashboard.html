<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Questbucket Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <!-- Make the whole layout stack on small screens -->
  <body class="flex flex-col md:flex-row h-screen bg-gray-100 text-gray-800">
    <!-- Sidebar -->
    <div
      id="sidebar"
      class="fixed inset-y-0 left-0 z-40 w-60 bg-white border-r border-gray-200 flex flex-col justify-between p-5 transform -translate-x-full md:translate-x-0 transition-transform duration-300 md:static md:inset-auto"
    >
      <div>
        <div class="flex justify-center mb-5">
          <img src="/assets/logo.svg" alt="Questbucket Logo" class="w-32" />
        </div>
        <div class="flex flex-col space-y-2">
          <button
            id="openFormBtn"
            class="w-4/5 mx-auto py-2 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-800 transition"
          >
            + Add
          </button>
          <ul class="mt-4 space-y-1">
            <li class="px-6 py-3 cursor-pointer hover:bg-gray-100 rounded">
              üîç Search
            </li>
            <a href="https://github.com/Aashish1-1-1/QuestBucket">
              <li class="px-6 py-3 cursor-pointer hover:bg-gray-100 rounded">
                ‚≠ê Star
              </li>
            </a>
          </ul>
        </div>
      </div>
    </div>

    <!-- Hamburger button for small screens -->
    <div class="md:hidden fixed top-3 left-3 z-50">
      <button
        id="sidebarToggle"
        class="p-2 bg-white rounded shadow-md focus:outline-none"
      >
        <svg
          class="w-6 h-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
          stroke-width="2"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M4 6h16M4 12h16M4 18h16"
          />
        </svg>
      </button>
    </div>

    <!-- Main content -->
    <div class="flex-1 flex flex-col">
      <!-- Navbar -->
      <div
        class="flex justify-end items-center bg-white border-b border-gray-200 p-3 relative"
      >
        <div class="relative">
          <div
            id="profile-btn"
            class="w-8 h-8 md:w-10 md:h-10 rounded-full overflow-hidden cursor-pointer"
          >
            <img
              src="{{.Pfp_url}}"
              alt="Profile"
              class="w-full h-full object-cover"
            />
          </div>
          <div
            id="popup"
            class="hidden absolute top-12 right-0 bg-white border border-gray-200 rounded-lg shadow-lg flex flex-col w-32"
          >
            <form action="/auth/logout" method="POST">
              <button class="px-4 py-3 text-left hover:bg-gray-100">
                Logout
              </button>
            </form>
          </div>
        </div>
      </div>

      <div class="flex-1 p-4 md:p-8 overflow-y-auto">
        <div class="mb-6">
          <!-- grid adjusts per screen size -->
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5">
            {{range .Quests}}
            <!-- Card -->
            <div
              class="bg-white p-5 rounded-xl shadow hover:-translate-y-1 transition h-full group"
            >
              <!-- Title row: View link + Pencil -->
              <div class="flex justify-between items-start">
                <!-- Title link -->
                <a
                  href="/post/{{.Questsid.String}}"
                  class="text-base md:text-lg font-medium mb-2 hover:underline"
                >
                  {{.Queststitle.String}}
                </a>
                <div
                  class="flex items-center space-x-2 opacity-0 group-hover:opacity-100 transition-opacity"
                >
                  <div
                    class="opacity-0 group-hover:opacity-100 transition-opacity"
                    title="Delete"
                    onclick="deleteItem('{{.Questsid.String}}')"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="h-5 w-5 text-red-500 hover:text-red-700"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6M9 7V4a1 1 0 011-1h4a1 1 0 011 1v3m-9 0h10"
                      />
                    </svg>
                  </div>
                  <!-- Pencil link appears on hover -->
                  <a
                    href="/edit/post/{{.Questsid.String}}"
                    class="opacity-0 group-hover:opacity-100 transition-opacity"
                    title="Edit"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="h-5 w-5 text-gray-500 hover:text-gray-700"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        d="M16.862 3.487a2.25 2.25 0 013.182 3.182L7.5 19.313 3 21l1.688-4.5L16.862 3.487z"
                      />
                    </svg>
                  </a>
                </div>
              </div>

              <!-- Description -->
              <p class="text-gray-500 text-sm">{{.Questdescription.String}}</p>

              <!-- Tags -->
              <div class="flex flex-wrap gap-2 mt-2">
                {{range .Questtag}}
                <span
                  class="bg-gray-200 text-gray-700 px-2 py-1 rounded-full text-xs font-medium"
                >
                  {{.}}
                </span>
                {{else}}
                <span class="text-gray-400 text-xs">No tags</span>
                {{end}}
              </div>
            </div>
            {{else}}
            <p class="text-gray-500">No quests found.</p>
            {{end}}
          </div>
        </div>
      </div>
    </div>

    <!--Toast-->
    <div
      id="toast"
      class="fixed bottom-5 left-1/2 -translate-x-1/2 bg-green-600 text-white px-4 py-2 rounded shadow-lg opacity-0 pointer-events-none transition-opacity duration-500"
    >
      Success
    </div>

    <!-- Popup Form -->
    <div
      id="overlay"
      class="hidden fixed inset-0 bg-black/40 flex justify-center items-center z-50"
    >
      <div
        class="bg-white p-8 rounded-xl w-96 max-w-[90%] flex flex-col gap-4 shadow-lg"
      >
        <h2 class="text-xl font-semibold mb-2">Add a New Note</h2>

        <!-- Title -->
        <input
          id="titleInput"
          required
          type="text"
          placeholder="Title"
          class="w-full p-2 border border-gray-300 rounded"
        />

        <!-- Short Description -->
        <input
          id="descriptionInput"
          required
          type="text"
          placeholder="Short Description"
          class="w-full p-2 border border-gray-300 rounded"
        />

        <!-- Note -->
        <textarea
          id="noteInput"
          rows="5"
          placeholder="Write your note here (you can leave it empty and update later)..."
          class="w-full p-2 border border-gray-300 rounded"
        ></textarea>

        <!-- Tags -->
        <div>
          <label class="block text-sm font-medium mb-1">Tags</label>
          <div
            id="tagContainer"
            class="flex flex-wrap items-center gap-2 p-2 border border-gray-300 rounded cursor-text"
            onclick="document.getElementById('tagInput').focus()"
          >
            <input
              id="tagInput"
              type="text"
              placeholder="Type and press Enter"
              class="flex-1 outline-none border-none focus:ring-0"
            />
          </div>
        </div>

        <!-- Submit Button -->
        <button
          id="submitFormBtn"
          class="py-2 bg-blue-600 text-white font-bold rounded hover:bg-blue-800 transition"
        >
          Add Note
        </button>
      </div>
    </div>
    <script src="dashboard.js"></script>
  </body>
</html>
